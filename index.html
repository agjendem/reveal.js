<!doctype html>
<html lang="no">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Monorepo med Git og Maven: hvordan læra gamle hunder nye triks</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/sb1.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section data-background="img/old-dog.jpg" data-background-size="contain">
                    <h2 style="text-shadow: 2px 2px 2px #C7C7C7;">Monorepo med Git og Maven</h2>
                    <br/><br/>
                    <h4 style="font-style: italic;color: white;text-shadow: 2px 2px 2px #282828;">hvordan læra gamle hunder nye triks</h4>
                    <br/><br/>
                    <br/><br/>
                    <br/><br/>
                    <hr/>
                    <small style="font-style: italic;color: white;">Anders Gjendem, Jonas Nordstrand</small>
                    <aside class="notes">
						Speaker notes til intro?
                        Bildkælla: https://pixabay.com/photos/dog-great-dane-old-animal-pet-2514968/ 
                    </aside>
				</section>

				<section>
					<h1>Agenda</h1>
					<ul>
                        <li>Monorepo 101</li>
						<li>Dilemmaet med felleskode</li>
						<li>Møt Monorepo</li>
						<li>Vår reise fra multi- til monorepo</li>
						<li>Utfordringar</li>
						<li>Effekter</li>
					</ul>
					<aside class="notes">
						<h6>En av oss:</h6>
						<p>
							Jeg heter ... og dette er ... og i dag skal vi snakke om våre erfaringer med monorepo.
						</p>
					</aside>
				</section>

                <section>
                    <h1>Monorepo 101</h1>

                    <ul>
                        <li>Oversikt</li>
                        <li>Vedlikholdbarhet</li>
                        <li>Versionering</li>
                        <li>Forenkling</li>
                    </ul>

                    <aside class="notes">
                        Monorepo ær ett kællkodesrepository dær man versioners ALL kode i en organisation.

                        All kode kan innebæra alla appar, all felleskode, all frontendkode, nativemobilapp kode, alla programmeringsspråk etc

                        Koden ær modularisering/avdelad i ett filtræd.

                        Trunkbaserad utveckling...
                        
                        Detta ær ett radikalt annorlunda sætt att jobba med kode æn multirepo och ger før- och nackdelar 
                        på olika områden,

                        Maven hanterar moduler med GAV-koordinater (groupId, artifcatId, version) i ett monorepo trengs inte
                        alla dessa koncepterna utan man kan bruka filsti istf. groupId/artifactId och git istf version.
                        
                        Monorepo != Monolit. Vi ønskar sjælvstændig deploy av apparna i monorepot vår.
                    </aside>
                </section>

                <section>
                    <section>
                        <h1>Felleskode: a mixed blessing</h1>
                        <ul>
                            <li>Gevinst</li>
                            <li>Koppling</li>
                        </ul>
                        <aside class="notes">
                            (3 min)
                            Har du inte felleskode så trenger du inte monorepo!
                            Om man har supermicroservice-arkitektur så har man kanske inte behov
                            før felleskode.

                            Men till och med google har felleskode.

                            VI trenger felleskode før vi ær en bank och vi ønskar inte
                            ha 18 olika implementationer av sessionsetablering (och egentligen ønskar vi inte
                            sessioner heller).
                        </aside>
                    </section>

                    <section data-timing="300">
                        <img src="img/felleskode-pr.png" alt="Bumping av versjonsnummer på mange interne bibliotek"/>

                        <aside class="notes">
                            <h6>En av oss:</h6>

                            Har du någon gång får en PR att review'a med en sådan hær diff?
                            En diff som bara innehåller bumpning'ar av versionsnummer før
                            felleskodeavhængigheter som appen din trenger?<br/>

                            Instick: versionsnummer i diffen: varfør står det dev och inte master dær?<br/>

                            Hur kændes det? Tog du dig bryet att eftergå exakt vilka kodeændringar
                            dessa, på ytan, så oskyldiga ændringar av versionnummer inførde?<br/>

                            Inte det..? Det ær svårt att klandra någon før det egentligen. Vi har
                            ofta mycket att gøra och finna fram till kodediffar i olika repo's baserat
                            på en diff som denna ær border-line infeasible i arbetsvardagen.
                            Att man kapitulerar och trots den lilla (eller stora) knuten i magen 
                            væljer att Approve'a ær bara naturligt.<br />

                            Måste det vara så hær? Kan man jobba felleskode på ett annat, smartare
                            sætt som leder till PR:s dær man faktiskt kan se vad det ær før kodeændringar
                            som inførs?

                            <hr/>
                            (5 min)
                            Utfordringer med klassisk modell for å håndtere felleskode:
                            Mange repository og artifaktpublisering (Arbeidsflyt, waste, branching modeller)

                        </aside>
                    </section>

                    <section data-background="img/app-deps-utan-jar.png" data-background-size="contain">
                        <aside class="notes">
                            <h6>En av oss:</h6>
                            <p>
                            TODO: se om det blir bættre om man lægger apparna i en kolonn till vænster och
                            libs i en kolonn till høger


                            Ett exempel: app1 ær en applikation som avhænger på felleskode i lib1,
                            app2 ær en applikation som avhænger på både lib1 och lib2

                            (5 min)
                            Utfordringer med klassisk modell for å håndtere felleskode:
                            Mange repository og artifaktpublisering (Arbeidsflyt, waste, branching modeller)
                            </p>
                        </aside>
                    </section>

                    <section data-background="img/app-deps-utan-jar-ci.png" data-background-size="contain">
                    </section>

                    <section data-background="img/app-deps-med-jar.png" data-background-size="contain">

                        <aside class="notes">
                            <h6>En av oss:</h6>
                            <p>
                            (5 min)
                            Det vi praktiken gør med maven ær att vi inte depend:ar på koden till våra avhængigheter,
                            direkte istællet avhængiger vi på byggda, versionerte artefakter, av koden. Detta føljer av
                            att varje kodebas tradionellt versionskontrollers i var sitt repo.

                            Ett exempel: man ønskar laga en feature i app1 som innebær att felleskode i lib1 samtidigt
                            måste ændras. Detta måste rent praktiskt ordnas som två PR-processer:
                            </p>
                            <ul>
                                <li>først en PR i lib1 dær
                                man inte ser ut felleskodeændringen træffar en ny app och som dærfør inte heller
                                ær møjlig att testa i en testmiljø.</li>
                                <li>
                                Nær denna PR ær mergead, och artefakt ær byggd, kan man få vidare med app1
                                dær man nu lagar en PR som bumpar versionnumret før artefakten. Denna PR kan
                                man inte se kodeændringen i libet i. Men man kan deploy'a och testa appen.
                                </li>
                            </ul>
                            <p>
                            Som en lite kicker: ingen har tænkt på app2 i detta sammahanget. Denna kan nu vara knæckt!
                            </p>
                        </aside>
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Monorepo 201</h1>
                        <h4>Google's definition</h4>
                                <ul>
                                    <li class="fragment fade-in">Centralization</li>
                                    <li class="fragment fade-in">Synchronization</li>
                                    <li class="fragment fade-in">Visibility</li>
                                    <li class="fragment fade-in">Completeness</li>
                                    <li class="fragment fade-in">Standardization</li>
                                </ul>
                                <br/><br/><br/>
                                <p><small>Efter: 
                        <a href="https://people.engr.ncsu.edu/ermurph3/papers/seip18.pdf">
                            Advantages and Disadvantages of a Monolithic Repository - A case study at Google
                        </a>
                    </small></p>
                        <aside class="notes">
                            <h6>En av oss:</h6>
                            <p>
                            <br/>
                                (7 min)
                                Vi ønsker oss enkelheten til ett repo, men fordelene fra å ha mange:
                                    Møt monorepo: Egenskaper (Cross cutting refactoring, søkbarhet, versjonering), og hvem passer det for?
                            </p>
                        </aside>
                    </section>

                    <section>
                        <h1>Centralization</h1>

                        <blockquote>The codebase is contained in a single
                            repo encompassing multiple projects
                        </blockquote>
                        <pre class="fragment"><code data-trim data-noescape>
.
├── apps
│   ├── app1
│   │   ├── pom.xml
│   │   └── src
│   ├── app2
│   │   ├── pom.xml
│   │   └── src
│   └── pom.xml
├── libs
│   ├── lib1
│   │   ├── pom.xml
│   │   └── src
│   ├── lib2
│   │   ├── pom.xml
│   │   └── src
│   └── pom.xml
├── pom.xml
├── README.md
                        </code></pre>
                        <aside class="notes">
                            Uppenbart det som diffentierar en monorepo-orgranisation från en som ær baserad på multirepo.
                            Istællet før att modularisera olika appar och fellesbibliotek baser på många olika repos
                            låter man dem hanteras i repo och brukar filtrædet før att hålla dem især.
                            (1) Centralization: The codebase is contained in a single
                            repo encompassing multiple projects.

                        </aside>
                    </section>

                    <section>
                        <h1>Synchronization</h1>

                        <blockquote>The development process is trunkbased; engineers commit to the head of the repo</blockquote>
                        <pre class="fragment"><code data-trim data-noescape>
$ find . -name '*.md' | \
  xargs sed -i 's/sparebank1/SpareBank 1/gi'
                        </code></pre>

                        <aside class="notes">
                            (3) Synchronization: The development process is trunkbased; engineers commit to the head of the repo.
                            - Når vi gjør endringer i felleskode i dag, så kan det ta månedsvis før alle har tatt inn endringene, og
                            det er vanskelig for den som endrer å gå rundt i alle prosjektene som bruker koden og rette det selv.
                            Det gjør at når noen etterslepere endelig skal oppgradere, og har spørsmål, har man for lengst glemt hva det handlet om.
                            Med monorepo må man også endre alle konsumentene, hvis ikke bryter bygget.

                        </aside>
                    </section>

                    <section>
                        <h1>Visibility</h1>
                        <blockquote>Code is viewable and searchable by all</blockquote>
                        <pre class="fragment"><code data-trim data-noescape>
$ git grep lib1 -- '**/pom.xml'
apps/app1/pom.xml:            &lt;groupId&gt;no.monorepo.libs.lib1&lt;/groupId&gt;
apps/app1/pom.xml:            &lt;artifactId&gt;lib1&lt;/artifactId&gt;
libs/lib1/pom.xml:    &lt;groupId&gt;no.monorepo.libs.lib1&lt;/groupId&gt;
libs/lib1/pom.xml:    &lt;artifactId&gt;lib1&lt;/artifactId&gt;
libs/pom.xml:        &lt;module&gt;lib1&lt;/module&gt;
                        </code></pre>
                        <aside class="notes">
                            TODO: fix lt; etc. i xml ovan


                            (2) Visibility: Code is viewable and searchable by all
                            engineers in the organization.
                            - Her ligger en av de store gevinstene for oss. 
                            Våre verktøy i dag er helt ubrukelig til å søke etter kode i. 
                            Om du er så heldig å finne noe, så aner du ikke om den versjonen du ser er den som er i bruk.
                        </aside>
                    </section>

                    <section>
                        <h1>Completenes</h1>

                        <blockquote>Any project in the repo can be built
                            only from dependencies also checked into the repo.
                            Dependencies are unversioned; projects must use
                            whatever version of their dependency is at the repo
                            head.</blockquote>

                        <aside class="notes">
                            (4) Completeness: Any project in the repo can be built
                            only from dependencies also checked into the repo.
                            Dependencies are unversioned; projects must use
                            whatever version of their dependency is at the repo
                            head.
                            - Denne er krevende å få til for en halvstor organisasjon.
                            Vi drar skillelinjen mellom tredjepartskode og vår felleskode.
                            De store kan ta kostnaden med å dra denne strikken enda lengre, og
                            versjonere _alt_ i eget repo, det er for ressurskrevende å følge
                            all tredjepartskode i detalj.
                            Vi har valgt å sjekke inn vår BOM som holder oversikt over- og
                            definerer hvilke tredjepartsbibliotek vi bruker.

                        </aside>
                    </section>

                    <section>
                        <h1>Standardization</h1>

                        <blockquote>
                            A shared set of tooling governs how
                            engineers interact with the code, including building,
                            testing, browsing, and reviewing code.
                        </blockquote>


                        <aside class="notes">
                            (5) Standardization: A shared set of tooling governs how
                            engineers interact with the code, including building,
                            testing, browsing, and reviewing code.
                            - Monorepo har i praksis vært forbeholdt de store aktørene fordi tooling
                            koster. De nødvendige verktøyene for å bruke monorepo på store prosjekter
                            begynner nå å bli tilgjengelig. Google har open sourcet deler av sitt byggeverktøy
                            Bazel som i disse dager blir sluppet i versjon 1.0. Bazel er et graf-basert
                            byggverktøy. Google har også gjort tilgjengelig en plugin for IntelliJ slik at 
                            det er relativt lett å ta i bruk. Microsoft har gjort
                            tilgjengelig sitt GVFS som gjør det mulig å versjonskontrollere
                            _store_ mengder kode i ett vanlig gitrepo. I tillegg har vi fått standarder som
                            CODEOWNERS for å håndtere eierskap til kode og reviewers på pull requests. 
                        </aside>
                    </section>
                </section>

				<section>
					<section>
						<h1>Vår reise fra multi- til monorepo</h1>

						<aside class="notes">
							<h6>En av oss:</h6>
							<p>
								(15 min)
								Vår reise fra multi til monorepo.
								Gå kjapt gjennom toolingen og repooppsettet vi hadde.
								Hvordan kan vi få de gode egenskapene til monorepo uten å snu hele verden opp ned?
							</p>
						</aside>
					</section>

                    <section>
                        <pre><code data-trim data-noescape>
.
├── apps
│   ├── app1
│   │   ├── pom.xml
│   │   └── src
│   ├── app2
│   │   ├── pom.xml
│   │   └── src
│   └── pom.xml
├── libs
│   ├── lib1
│   │   ├── pom.xml
│   │   └── src
│   ├── lib2
│   │   ├── pom.xml
│   │   └── src
│   └── pom.xml
├── pom.xml
├── README.md

                        </code></pre>
                    </section>

                    <section>
                        <img src="img/maven-moduler.png" alt="oversikt over maven moduler i prosjektet" style="background:none; border:none; box-shadow:none; ">
                        <aside class="notes">

                            <h6>En av oss:</h6>
                            <p>Maven ær i grunden ett rekursivt byggsystem, ikke ett DAG-baserat 
                               som bazel.
                            </p>
                        </aside>
                    </section>

                    <section>
                        <img src="img/maven-moduler-deps.png" alt="oversikt over maven moduler i prosjektet med noen avhengigheter" style="background:none; border:none; box-shadow:none; ">
                        <aside class="notes">

                            <h6>En av oss:</h6>
                            <p>Men kan ha avhængigheter på tværs av filtrædstruktur


                            </p>
                        </aside>
                    </section>
                    <section>
                        <pre><code data-trim data-noescape>
$ mvn clean install
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Build Order:
[INFO]
[INFO] root                                                               [pom]
[INFO] libs                                                               [pom]
[INFO] lib2                                                               [jar]
[INFO] lib1                                                               [jar]
[INFO] apps                                                               [pom]
[INFO] app1                                                               [jar]
[INFO] app2                                                               [jar]
[INFO]
                        </code></pre>
                        <aside class="notes">

                            <h6>En av oss:</h6>
                            <p>Det ær avhængigheterna mellan modulerna som bestæmmer i vilken ordning
                               modulerna byggs.
                            </p>
                        </aside>
                    </section>

                    <section>
                        <pre><code data-trim data-noescape>
$ apps/app1 $ mvn clean install
[INFO] Scanning for projects...
[INFO]
[INFO] --------------------------< no.monorepo:app1 >--------------------------
[INFO] Building app1 1.0.0-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------

                        </code></pre>

                        <aside class="notes">
                            Hær bygget maven rekursivt från apps/app1 och bygger inga avhængigheter
                            till app1 som ligger utanfør aktuell arbetskatalog i filsystemet.
                        </aside>
                    </section>
                    <section>
                        <pre><code data-trim data-noescape>
apps/app1 $ mvn <mark>-f ../.. -pl :app1 -am</mark> clean install
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Build Order:
[INFO]
[INFO] root                                                               [pom]
[INFO] libs                                                               [pom]
[INFO] lib2                                                               [jar]
[INFO] lib1                                                               [jar]
[INFO] apps                                                               [pom]
[INFO] app1                                                               [jar]
[INFO]
                        </code></pre>
						<aside class="notes">
							<ul>
								<li>-f: --file (ange filsti till rot-pom, krævs før att Maven ska upptæcka alla moduler)</li>
								<li>-pl: --projects (projektlistan, vilka moduler Maven ska bygga) </li>
								<li>-am: --also-make (instruerar Maven att bygga alla avhængigheter till modulerna
									som angetts i projektlistan) </li>
							</ul>
						</aside>
                    </section>
					<section>
						<h1>partial-build-plugin</h1>
					</section>
					<section>
						<h1>Mavenutfodringar</h1>
						<ul>
							<li>version - bør hærledas från versionskontroll instællet</li>
							<li>groupId - bør hærledes från filtrædstruktur istællet</li>
							<li>Trenger ny version av Maven: minnelæckagefixar och CI-friendly versions</li>
						</ul>
						<aside class="notes">
							<ul>
								<li>Bruk av project.version før att referer till monorepointerna dependencies</li>
								<li>ci-profil som sætter revision-property'n från miljøvariabel: fungerar næstan</li>
								<li>https://issues.apache.org/jira/browse/MNG-6412</li>
							</ul>
							<p>Bazel har inget versionsbegrepp, bygger filstrukturen på disk som versionshanteras av VCS</p>
							<p>Bazel har inget grupperingsbegrepp à la maven groupId,
								gruppering på disk ær identiskt med katalogstrukturken</p>

						</aside>
					</section>
					<section>
                        <h1>Versionering i Maven</h1>
                        <pre><code data-trim data-noescape>
&lt;project&gt;
  &lt;groupId&gt;no.monorepo.libs&lt;/groupId&gt;
  &lt;artifactId&gt;lib1&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
					</code></pre>
                    </section>
                    <section>
                        <h1>CI-friendly versioning</h1>
                        <pre><code data-trim data-noescape>
&lt;project&gt;
  &lt;groupId&gt;no.monorepo.libs&lt;/groupId&gt;
  &lt;artifactId&gt;lib1&lt;/artifactId&gt;
  &lt;version&gt;${revision}&lt;/version&gt;

  &lt;properties&gt;
    &lt;revision&gt;1.0-SNAPSHOT&lt;/revision&gt;
  &lt;/properties&gt;
                        </code></pre>
						<pre class="fragment fade-up"><code data-trim data-noescape>
$ mvn -Drevision=$(git rev-parse HEAD) clean install
						</code></pre>
						<aside class="notes">
							<p>Med <a href="https://maven.apache.org/maven-ci-friendly.html">ci-friendly</a>
								trenger man inte mutera pom-filer med mvn versions:set
							</p>
						</aside>
                    </section>
					<section>
						<h1>Flata pom-filer</h1>
						<aside class="notes">
							<p>Før att undgå att pom-filer med ikke-resolverade $revision inslag blir installerade bør
							man bruka Maven flatten-plugin'en. Denna resolva'r revsion och installerar en flat pom.xml fil
							som man kan bruka vidare utan problem</p>
						</aside>
					</section>
					<section>
                        <pre><code data-trim data-noescape>
&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;no.monorepo.libs.lib1&lt;/groupId&gt;
    &lt;artifactId&gt;lib1&lt;/artifactId&gt;
    &lt;version&gt;${project.version}&lt;/version&gt;
  &lt;/dependency&gt;
						</code></pre>
					</section>
					<section>
						<h1>filsti == groupId</h1>
						<p><span><code>libs/lib1</code> &rArr;</span> <code class="fragment fade-in">no.monorepo.libs.lib1</code></p>
						<p><span class="fragment fade-in"><code>apps/app2</code> &rArr;</span> <code class="fragment fade-in">no.monorepo.apps.app2</code></p>
						<aside class="notes">
							<p>Maven's namespace før moduler ær baserat på groupId-begreppet. I ett monorepo ær name space
							ivaratatt av filkatalog-hiearkin. Nær man brukar Maven før monorepo bør man vurdera att sætta
							groupId identisk med filsti.</p>
						</aside>
					</section>
					<section>
						<h1>CODEOWNERS</h1>
						<pre class="fragment fade-up"><code data-trim data-noescape>
# Default owner
/ @nordstrand

# Code owner for the applications
/apps/app1/   @nordstrand
/apps/app2/   @agjendem
						</code></pre>

						<img src="img/codereview-in-github.png" alt="eksempel på hvordan github viser codereviewers via codeowners-fil" class="fragment fade-in"/>

						<aside class="notes">
							<p>En av de stor førdelarna med multirepo ær att det ær lætt før team att vara autonoma och sætta
							upp egna rutiner kring tilgång till kællkod och rutiner kring peer review, Pull Requests på egen hand.
							I ett monorepo måste detta centraliseras i større utstræckning på tværs av team. Ett vanligt
							uppsætt ær att øppna før read før alla, men kræva godkænd pull request før att få lov att ta ned kode på trunk.</p>

							<p>
							En CODEOWNERS-fil i monorepot gør det møjligt att ange vilka team/teammedlemmar som æger koden under olika filstier.
							Detta kan brukas till f.eks. automatiskt lægga in ægare som reviewers på Pull requester som træffar
								deras respektive kode.</p>

							<p>CODEOWNERS-filformatet ær <a href="https://help.github.com/articles/about-codeowners/">standardiserat</a>
							och støds av Github (før tillfællet bara i betalt/PRO-utførande), Gitlab och Bitbucket Server (med plugin).
							</p>

							<p>I detta exemplet blir Anders automatiskt lagt till som reviewer (med speciell-nøkkehålikon) på alla PR:s
							som træffar hans app - app2.</p>
						</aside>
					</section>
                    <section>
                        <h1>Jenkins(file)</h1>
                    </section>

                    <section>
                        <h1>Git sparse checkouts</h1>
                    </section>
					<section>
						<h1>Løsninger</h1>
						<ul>
							<li>Git VFS / large file storage</li>
							<li>Bazel?</li>
							<li>Archunit?</li>
						</ul>
					</section>

					<section>
                        Restpost
						<aside class="notes">
							<h6>En av oss:</h6>
                            <ul>
                                <li>Bazel?
                                    <ul>
                                        <li>JVM-external</li>
                                        <li>Maven-dependencies</li>
                                        <li>IntelliJ-støtte</li>
                                    </ul>
                                </li>
                                <li>Python i Monorepo?</li>
                                <li>Rydde i repo</li>
                                <li>Archeunit.org - medisin mot monolitt i monorepo
                                    <ul>
                                        <li>no.sb1.apps.app_a</li>
                                        <li>no.sb1.libs</li>
                                        <li>Hva med Python og Go?</li>
                                    </ul>
                                </li>
                            </ul>
						</aside>
					</section>
				</section>

				<section>
					<section>
						<h1>Rosa sky eller tornekratt?</h1>

                        <ul>
                            <li>Stort repo</li>
                            <li>Långa byggtider</li>
                            <li>The race to push</li>
                            <li>Omogna verktyg</li>

                       </ul>
						<aside class="notes">
							<h6>En av oss:</h6>
							<p>
								(7 min)
								Hvilke nye utfordringer får vi nå?
								* Umodne verktøy (Maven vs Bazel, BitBucket / GitHub vs Gerrit)
								* Tvinges til mer kortlevde brancher
								* Skalering
							</p>
						</aside>
					</section>

                    <section>
                        <h1>Stort repo</h1>
                        <ul>
                            <li>.git/</li>
                            <li>work tree</li>
                        </ul>

                        <aside class="notes">
                            Sparse checkouts hjælper mot stora working trees.

                            Næmn något kring andra stora repos som googles, microsoft windowsrepot (som GVFS)

                            Hantering av stora filer/binærer: "Git large file support"
                        </aside>
                    </section>

                    <section>
                        <h1>Långa byggtider</h1>
                        <ul>
                            <li>Ikke bygg allt alltid/</li>
                            <li>Ikke bygg fra cleant alltid (vurdera alternativ till Maven)</li>
                            <li>Bazel har stød før build cache och build workers</li>
                        </ul>

                        <aside class="notes">
                            Bazel har stød før 100% pålitligta inkrementella bygg vilket troligen hjælper till med CI rætt bra.
                        </aside>
                    </section>

                    <section>
                        <h1>The race to push</h1>

                        <aside class="notes">
                            <a href="https://docs.microsoft.com/en-us/azure/devops/learn/git/race-to-push">The race to push</a>
                        </aside>
                    </section>

                    <section>
                        <h1>Øvermogna verktyg</h1>
                        <ul>
                            <li>Maven ær javacentrisk och generellt "clunky" i ett monorepo</li>
                        </ul>
                        <aside class="notes">
                            <p>
                            Førsta release av Maven slæpptes 30 mars 2002. 
                            Maven ær ældre æn git, FaceBook och java generics.
                            
                            Maven firar snart 20-årsjubileum...
                            <a href="https://maven.apache.org/docs/history.html">Maven release history</a><br/>

                            Maven clunkyness i monorepo-sammanhang:
                            </p>
                            <ul>
                                <li>Ikke polyglot - javacentrisk</li>
                                <li>Sparse checkout måste hackas, mavens repomodell byggs upp av pom.xml filer
                                    - ikke vad som finns på disk</li>
                                <li>Maven trenger explicit referens till roten av repo't, Bazel finner den fint sjælv</li>
                                <li>Manglar inkrementella bygg</li> 
                                <li>Maven brukar groupId och version-begrepp før moduler som i ett monorepo hellre avledsi
                                    från filkatalogstrukt resp. git</li>
                            </ul>
                        </aside>
                    </section>
                    <section>
                        <h1>Omogna verktyg</h1>
                        <ul>
                            <li>Bazel er i beta og har middels verktøystøtte foreløpig</li>
                            <li>CI - saknar færdiga løsningar før att bygga delmængder av monorepos</li>
                            <li>Bitbucket/Github saknar i grunden støra monorepos - CODEOWNERS ær dock en band aid</li>
                        </ul>
                        <aside class="notes">
                            <p>
                            TODO
                            </p>
                        </aside>
                    </section>
				</section>

				<section>
                    <section>
                        <h1>Effekter</h1>

                        <aside class="notes">
                            <h6>En av oss:</h6>
                            <p>
                            (7 min)
                            Med monorepo; hva blir mer viktig, og hva blir mindre viktig?
                            Hvordan påvirker monorepo samarbeidet i organisasjonen?
                            Positive bi-effekter av monorepo.
                            </p>
                        </aside>
                    </section>
					<section>
                        <h1>Versionering</h1>
						<aside class="notes">
							<h6>En av oss:</h6>
							<p>
                                Tidigare versionerade vi i git _och_ maven. I monorepo versionerar vi bara i git.

                                Konceptuellt lættare att førhålla sig till git (en viss SHA1 tillsvarar att
                                allt ska vara i sync), æn att førhålla sig till dependency managemnt, semver,
                                bom'ar, snapshots, dependency version convergence (risiko før detta utgår helt på
                                egen felleskode i monorepot, 3e part kan fortfarande vara ett issue om dessa ikke
                                också ligger i monorepot)
							</p>
						</aside>
					</section>
                    <section>
                        <h1>Ændring i felleskode</h1>
                        <h4>Bilde av glada folk med blomster?</h4>
                        <aside class="notes">
                            <h6>En av oss:</h6>
                            <p>
                                Tidigare kunde man ændra felleskode utan att att ta ansvara før att integrera
                                ændringen i konsumenterna. Med monorepo blir man mer ansvarligt før konsumenterna,
                               det blir också praktiskt møjligt att gøra det.

                               Holistiska PR dær man ser alla ændringar och det blir praktiskt møjligt med en
                               helhetlig code review.

                               Atomiska refaktoreringar.

                               T2M før felleskodeændring/sikkerhetspatching går radikalt ned. True _continous_ integration!

                               Mindre behov før komplex tooling før att hålla appar uppdaterade med nya versioner
                               av felleskode.
                                
                               Praktiskt møjligt att få rask feedback på konsekveserna av ændring av felleskode,
                               sænker trøskeln før att att folk vågar refaktorer/bidra till felleskode.
                            </p>
                        </aside>
                    </section>
                    <section>
                        <h2>Du får det till med Maven, Jenkins och Git!</h2>
                        <h2>...men på sikt måste Maven gå!</h2>
                    </section>
				</section>


				<section>
					<h1>Takk for oss</h1>

					<p>
						<a href="https://github.com/SpareBank1/monorepo-sample">github.com/SpareBank1/monorepo-sample</a><br/>
						<img style="width:300px;height:300px" alt="QR-kode til https://github.com/SpareBank1/monorepo-sample" src="img/repo-url-qr.png" />
					</p>

					<h4>kortreistkode.no</h4>
					<h4>Jonas Nordstrand / Anders Gjendem</h4>

					<aside class="notes">
						<h6>En av oss:</h6>
						<p>
							Hejdå!
						</p>
					</aside>
				</section>
			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
